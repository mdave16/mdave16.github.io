---
layout: default
title: Tic Tac Toe
---

<style>
    .grid {
        display: grid;
        grid-template-columns: 32.5% 32.5% 32.5%;
        grid-template-rows: 104px 104px 104px;
        background-color: #2196f3;
        padding: 10px;
        grid-gap: 10px;
    }

    .cell {
        background-color: rgba(255, 255, 255, 0.8);
        padding: 20px;
        font-size: 4rem;
        text-align: center;
    }
</style>

<div class="grid" id="grid">
    {% for i in (1..9) %}
    <div class="cell" data-played></div>
    {% endfor %}
</div>

<div id="gameOverlay">
    <span id="info"></span>
    <span id="score"></span>
    <button class="button-primary hidden" id="reset-button" onclick="reset()">
        Reset
    </button>
</div>

<script>
  let player = "X"
  let score = {X: 0, O: 0}
  const winningCombos = [
    // horizontal
    [0, 1, 2],
    [3, 4, 5],
    [6, 7, 8],
    // vertical
    [0, 3, 6],
    [1, 4, 7],
    [2, 5, 8],
    //diagonal
    [0, 4, 8],
    [2, 4, 6]
  ]
  const cells = () => Array.from(document.getElementsByClassName("cell"))
  const winner = () => {
    const grid = cells().map(cell => cell.dataset.played)
    const combo = winningCombos.filter(
      combo =>
        grid[combo[0]] === grid[combo[1]] &&
        grid[combo[0]] === grid[combo[2]] &&
        grid[combo[0]] !== ""
    )
    return combo.length > 0
  }
  const over = () => cells()
    .map(c => c.dataset.played)
    .every(c => c !== "")
  const reset = () => {
    cells().forEach(cell => (cell.dataset.played = ""))
    document.getElementById("reset-button").classList.toggle("hidden")
  }
  const play = cell => {
    if (!document.getElementById("reset-button").classList.contains("hidden")) {
      return null
    }
    if (cell.dataset.played === "") {
      cell.dataset.played = player
      if (winner()) {
        alert(`Congratulations! The winner is: ${player}.`)
        document.getElementById("reset-button").classList.toggle("hidden")
        document.getElementById(
          "info"
        ).innerText = `Congratulations! The winner is: ${player}.`
        score[player]++
        document.getElementById(
          "score"
        ).innerText = `Current score: X: ${score["X"]} - O: ${score["O"]}`
      } else if (over()) {
        alert("Game over. Try again.")
        document.getElementById("reset-button").classList.toggle("hidden")
        document.getElementById("info").innerText = `Game over. Try again.`
      } else {
        player = player === "X" ? "O" : "X"
        document.getElementById("info").innerText = `Current player: ${player}.`
      }
    }
  }

  document.addEventListener("DOMContentLoaded", _ => {
    document
      .getElementById("grid")
      .addEventListener("click", e => play(e.target))
  })
</script>
